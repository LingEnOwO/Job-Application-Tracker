(function(){"use strict";function l(){return window.location.hostname.includes("greenhouse.io")||document.querySelector(".app-title")!==null||document.querySelector("#application_form")!==null}function m(){const t={};if(document.title){const a=document.title.match(/\bat\s+(.+)$/);a&&(t.company=a[1].trim())}if(!t.company){const o=window.location.pathname.match(/^\/([^\/]+)\/jobs\//);o&&(t.company=o[1].charAt(0).toUpperCase()+o[1].slice(1))}const c=document.querySelector('.app-title, h1.app-title, [data-qa="job-title"]');c&&(t.position=c.textContent.trim());const e=document.querySelector(".location, .app-location");e&&(t.location=e.textContent.trim()),t.jobDescription=p();const i=window.location.pathname.match(/\/jobs\/(\d+)/);return i&&(t.jobId=i[1]),t}function p(){const t=["#job_description",'[data-qa="job-description"]',"main.job-post",".job-post-container","#content .job__description",".job-description","#content"];let c=null;for(const n of t)if(c=document.querySelector(n),c)break;if(!c)return"";const e=c.cloneNode(!0);["#application","form",".application--container",".application-form","#application_form",".location",".job__location",".app-location","header",".image-container",".logo",".divider",".content-intro",".job-alert",".app-title","h1",".tag-text"].forEach(n=>{e.querySelectorAll(n).forEach(r=>r.remove())}),e.querySelectorAll("a").forEach(n=>{n.textContent.toLowerCase().includes("back to jobs")&&n.remove()});const a=Array.from(e.querySelectorAll("h1, h2, h3, h4, h5, h6, button"));for(const n of a){const r=n.textContent.toLowerCase();if(r.includes("apply for this job")||r.includes("apply now")||r==="apply"){let s=n;for(;s;){const C=s.nextSibling;s.remove(),s=C}break}}let o=e.textContent.trim();if(o=o.replace(/^[A-Z][a-z]+,\s+[A-Z]{2}(;\s+[A-Z][a-z]+,\s+[A-Z]{2})*\s*/,""),o=o.replace(/^Apply\s+/,""),o.includes("Apply for this job")){const n=o.indexOf("Apply for this job");o=o.substring(0,n).trim()}return o}function d(){return window.location.hostname.includes("lever.co")||document.querySelector('[data-qa="posting-name"]')!==null||document.querySelector(".posting")!==null}function u(){const t={};try{const o=document.querySelector('script[type="application/ld+json"]');if(o){const n=JSON.parse(o.textContent);n.hiringOrganization&&n.hiringOrganization.name&&(t.company=n.hiringOrganization.name)}}catch{}if(!t.company){const o=document.querySelector('meta[property="og:site_name"]');o&&(t.company=o.content)}if(!t.company&&document.title){const o=document.title.match(/\bat\s+(.+)$/);o&&(t.company=o[1].trim())}if(!t.company){const o=document.querySelector(".main-header-text-logo, .company-name");o&&(t.company=o.textContent.trim())}const c=document.querySelector('[data-qa="posting-name"], .posting-headline h2');c&&(t.position=c.textContent.trim());const e=document.querySelector('.posting-categories .location, [data-qa="posting-location"]');e&&(t.location=e.textContent.trim());const i=document.querySelector(".section-wrapper, .posting-description");i&&(t.jobDescription=i.textContent.trim());const a=window.location.pathname.match(/\/([a-f0-9-]+)$/);return a&&(t.jobId=a[1]),t}function y(){return window.location.hostname.includes("ashbyhq.com")||document.querySelector('[data-testid="job-title"]')!==null||document.querySelector(".ashby-job-posting")!==null}function f(){const t={};try{const o=document.querySelector('script[type="application/ld+json"]');if(o){const n=JSON.parse(o.textContent);n.hiringOrganization&&n.hiringOrganization.name&&(t.company=n.hiringOrganization.name)}}catch{}if(!t.company&&window.location.hostname==="jobs.ashbyhq.com"){const n=window.location.pathname.match(/^\/([^\/]+)/);n&&(t.company=n[1].split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" "))}const c=document.querySelector('[data-testid="job-title"], h1');c&&(t.position=c.textContent.trim());const e=document.querySelector('[data-testid="job-location"]');e&&(t.location=e.textContent.trim());const i=document.querySelector('meta[name="description"]');if(i&&i.content)t.jobDescription=i.content.trim();else{const o=document.querySelector('[data-testid="job-description"], .job-description');o&&(t.jobDescription=o.textContent.trim())}const a=window.location.pathname.match(/\/([a-f0-9-]+)$/);return a&&(t.jobId=a[1]),t}function h(){return window.location.hostname.includes("myworkdayjobs.com")||document.querySelector('[data-automation-id="jobPostingHeader"]')!==null||document.querySelector(".jobProperty")!==null}function b(){const t={},e=window.location.hostname.match(/^([^.]+)\./);if(e&&(t.company=e[1].charAt(0).toUpperCase()+e[1].slice(1)),!t.company)try{const r=document.querySelector('script[type="application/ld+json"]');if(r){const s=JSON.parse(r.textContent);s.hiringOrganization&&s.hiringOrganization.name&&(t.company=s.hiringOrganization.name)}}catch{}const i=document.querySelector('h2[data-automation-id="jobPostingHeader"], .jobPostingHeader h2');i&&(t.position=i.textContent.trim());const a=document.querySelector('[data-automation-id="locations"], .jobProperty.location');a&&(t.location=a.textContent.trim());const o=document.querySelector('[data-automation-id="jobPostingDescription"], .jobDescription');o&&(t.jobDescription=o.textContent.trim());const n=document.querySelector('[data-automation-id="requisitionId"]');return n&&(t.jobId=n.textContent.trim()),t}function g(){return window.location.href}function j(){const t={},c=document.querySelector('meta[property="og:title"]'),e=document.querySelector('meta[property="og:site_name"]'),i=document.querySelector('meta[property="og:description"]');if(c&&(t.position=c.content),e&&(t.company=e.content),i&&(t.jobDescription=i.content),!t.position){const o=document.querySelector('meta[name="twitter:title"]');o&&(t.position=o.content)}!t.position&&document.title&&(t.position=document.title);const a=document.querySelectorAll('script[type="application/ld+json"]');for(const o of a)try{const n=JSON.parse(o.textContent);if(n["@type"]==="JobPosting"){n.title&&(t.position=n.title),n.hiringOrganization?.name&&(t.company=n.hiringOrganization.name),n.description&&(t.jobDescription=n.description),n.jobLocation?.address?.addressLocality&&(t.location=n.jobLocation.address.addressLocality);break}}catch{}return t}function S(){return l()?"greenhouse":d()?"lever":y()?"ashby":h()?"workday":null}function q(t){switch(t){case"greenhouse":return m();case"lever":return u();case"ashby":return f();case"workday":return b();default:return{}}}function x(){const t={};if(document.title){const e=document.title.split(/[-|@]/);if(e.length>0){const i=e[0].trim();i.length>3&&(t.position=i)}}if(!t.position){const e=document.querySelector("h1");e&&(t.position=e.textContent.trim())}try{const e=document.querySelector('script[type="application/ld+json"]');if(e){const i=JSON.parse(e.textContent);i.hiringOrganization&&i.hiringOrganization.name&&(t.company=i.hiringOrganization.name)}}catch{}if(!t.company){const e=document.querySelector('meta[property="og:site_name"]');e&&(t.company=e.content)}if(!t.company&&document.title){const e=document.title.match(/\bat\s+(.+)$/);e&&(t.company=e[1].trim())}if(!t.company){const e=[".company-name",".employer-name",'[itemprop="hiringOrganization"]',".company"];for(const i of e){const a=document.querySelector(i);if(a){t.company=a.textContent.trim();break}}}const c=document.querySelector("main, article, .job-description, .description");return c&&(t.jobDescription=c.textContent.trim()),t}function w(){const t=new Date,c=t.getFullYear(),e=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),a=`${c}-${e}-${i}`,o={jobUrl:g(),applyDate:a},n=j();Object.assign(o,n);const r=S();if(r){const s=q(r);Object.assign(o,s),o.atsDetected=r}else{const s=x();Object.assign(o,s)}return o.position&&(o.position=o.position.trim()),o.company&&(o.company=o.company.trim()),o.jobDescription&&(o.jobDescription=o.jobDescription.substring(0,1e4).trim()),o}chrome.runtime.onMessage.addListener((t,c,e)=>{if(t.action==="extract")try{const i=w();e({success:!0,data:i})}catch(i){e({success:!1,error:i.message})}return!0})})();
