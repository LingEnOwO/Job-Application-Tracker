<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Application Tracker</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <header class="app-header">
            <h1>Job Application Tracker</h1>
            <div class="header-actions">
                <button id="addRowBtn" class="btn btn-secondary">+ Add Application</button>
                <div class="more-menu-container">
                    <button id="moreMenuBtn" class="btn btn-icon-only" aria-label="More actions" title="More actions">
                        <span class="more-icon">‚ãØ</span>
                    </button>
                    <div id="moreMenu" class="more-menu" style="display: none;">
                        <button class="menu-item" id="menuExportCsv">Export CSV</button>
                        <button class="menu-item" id="menuExportJson">Export JSON</button>
                        <button class="menu-item" id="menuImportJson">Import JSON</button>
                        <input type="file" id="importJsonInput" accept=".json" style="display: none;">
                        <div class="menu-separator"></div>
                        <button class="menu-item menu-item-danger" id="menuClearAll">Clear all applications</button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Notes Section -->
        <div class="notes-section">
            <div class="notes-header">
                <span class="notes-icon">üìù</span>
                <span class="notes-title">Notes</span>
                <button id="toggleNotesBtn" class="btn-icon">‚ñº</button>
            </div>
            <div class="notes-content" id="notesContent">
                <div class="notes-toolbar">
                    <button class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)"><strong>B</strong></button>
                    <button class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)"><em>I</em></button>
                    <button class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)"><u>U</u></button>
                    <button class="toolbar-btn" data-command="strikeThrough" title="Strikethrough"><s>S</s></button>
                    <span class="toolbar-divider"></span>
                    <button class="toolbar-btn" data-command="insertUnorderedList" title="Bulleted List">‚Ä¢</button>
                    <button class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">1.</button>
                </div>
                <div id="notesEditor" class="notes-editor" contenteditable="true"
                    data-placeholder="Add important notes here (e.g., upcoming deadlines, interview tips, etc.)..."></div>
            </div>
        </div>

        <!-- Filters and Search -->
        <div class="controls-section">
            <div class="filters-group">
                <label class="control-label">Filter by Stage:</label>
                <div class="filter-chips" id="filterChips">
                    <button class="filter-chip active" data-stage="all">All</button>
                    <button class="filter-chip" data-stage="Applied">Applied</button>
                    <button class="filter-chip" data-stage="OA">OA</button>
                    <button class="filter-chip" data-stage="Phone">Phone</button>
                    <button class="filter-chip" data-stage="Interview">Interview</button>
                    <button class="filter-chip" data-stage="Offer">Offer</button>
                    <button class="filter-chip" data-stage="Rejected">Rejected</button>
                </div>
            </div>
            <div class="search-group">
                <label class="control-label">Search:</label>
                <input type="text" id="searchInput" class="search-input"
                    placeholder="Search by company, position, or notes...">
            </div>
            <div class="count-display">
                <span class="count-pill" id="todayCount">Today: 0</span>
                <span class="count-pill" id="totalCount">Total: 0</span>
            </div>
        </div>

        <div class="main-content">
            <div class="table-container">
                <div id="emptyState" class="empty-state">
                    <div class="empty-state-icon">üìã</div>
                    <h2>No applications yet</h2>
                    <p>Click the extension icon on a job posting to save your first application</p>
                </div>

                <table id="applicationsTable" class="applications-table" style="display: none;">
                    <thead>
                        <tr>
                            <th class="expand-gutter"></th>
                            <th data-sort="applyDate" class="sortable sorted-desc">Apply Date</th>
                            <th data-sort="company" class="sortable">Company</th>
                            <th data-sort="position" class="sortable">Position</th>
                            <th data-sort="jobId" class="sortable col-job-id">Job ID</th>
                            <th data-sort="stage" class="sortable">Stage</th>
                            <th data-sort="responseDate" class="sortable">Response Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Rows will be inserted here -->
                    </tbody>
                </table>
            </div>

            <div id="sidePeek" class="side-peek">
                <div class="side-peek-header">
                    <h2>Application Details</h2>
                    <button id="closeSidePeek" class="btn-icon">&times;</button>
                </div>
                <div class="side-peek-content" id="sidePeekContent">
                    <!-- Content will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Clear All Confirmation Modal -->
    <div id="clearAllModal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <h2 class="modal-title">Delete all applications?</h2>
            <p class="modal-body">
                This will permanently remove all job applications from this device.
                <strong>This action cannot be undone.</strong>
            </p>
            <p class="modal-count" id="modalCount"></p>
            <div class="modal-confirmation">
                <label for="deleteConfirmInput" class="confirmation-label">Type <strong>DELETE</strong> to confirm</label>
                <input type="text" id="deleteConfirmInput" class="confirmation-input" placeholder="DELETE" autocomplete="off">
            </div>
            <div class="modal-actions">
                <button id="modalCancelBtn" class="btn btn-secondary">Cancel</button>
                <button id="modalDeleteBtn" class="btn btn-danger" disabled>Delete all</button>
            </div>
        </div>
    </div>

    <!-- Import JSON Modal -->
    <div id="importModal" class="modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <h2 class="modal-title">Import applications</h2>
            
            <div class="import-options">
                <label class="import-option">
                    <input type="radio" name="importMode" value="add" checked>
                    <div class="option-content">
                        <div class="option-title">Add to current sheet <span class="recommended-badge">(recommended)</span></div>
                        <div class="option-description">
                            Imported applications will be added to your existing data.
                            Existing applications will remain unchanged.
                        </div>
                    </div>
                </label>

                <label class="import-option destructive-option">
                    <input type="radio" name="importMode" value="replace">
                    <div class="option-content">
                        <div class="option-title">Replace all existing data</div>
                        <div class="option-description">
                            This will delete all existing applications and replace them with the imported data.
                            <strong>This action cannot be undone.</strong>
                        </div>
                    </div>
                </label>
            </div>

            <div class="modal-confirmation" id="importConfirmation" style="display: none;">
                <label for="replaceConfirmInput" class="confirmation-label">Type <strong>REPLACE</strong> to confirm</label>
                <input type="text" id="replaceConfirmInput" class="confirmation-input" placeholder="REPLACE" autocomplete="off">
            </div>

            <div class="modal-actions">
                <button id="importCancelBtn" class="btn btn-secondary">Cancel</button>
                <button id="importConfirmBtn" class="btn btn-primary">Import</button>
            </div>
        </div>
    </div>

    <script src="app.js" type="module"></script>
</body>

</html>